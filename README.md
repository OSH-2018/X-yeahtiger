# 热部署项目

## 小组成员

隆晋威

吴昊

伊昕宇

魏天心

## 目录

/doc  文档目录，包括调研报告和可信性报告

/demo 演示程序目录，演示项目各部分实现原理的最小范例

## faq
1. 和kpatch相比怎么样?
  kpatch是RedHat主导开发的“内核在线升级”工具，可在不重启系统、不中断业务的情况下实现内核在线升级。实现函数级别的执行流程替换。其基本原理为：基于ftrace，类似于ftrace的动态探测点，利用mcount机制，在内核编译时，在每个函数入口保留数个字节，然后在打补丁时，将“被替换函数”入口保留   的字节替换为跳转指令，跳转到kpatch的相关流程中，然后进入“新函数”的执行流程，实现函数级别的执行流程在线替换，最终实现“内核在线升级”的功能。
虽然较为完善但kpatch有一些不足之处：
  1. 某些函数不支持hot patch，如（schedule(), sys_poll(), sys_select(), sys_read(), sys_nanosleep()）
  2. 初始化函数不支持hot patch,如__init
  3. 不支持修改静态分配的数据
  4. 不支持vdso中的函数进行patch
  5. kpatch和ftrace以及kprobes存在不兼容
  6. 改变函数与动态分配数据间的交互的patch可能存在安全性问题。
  7. 会停止所有正在运行的进程和中断
我们实现的热部署方案会在这些缺点的基础上进行改进并实现：
  1. 支持对更多的函数进行热部署
  2. 通过其他手段实现热部署，避免工具之间的不兼容性
  3. 提高安全性能，减少安全问题
  4. 能实现对静态数据的一定修改
  5. 提高执行效率和性能，减少对原进程的影响
